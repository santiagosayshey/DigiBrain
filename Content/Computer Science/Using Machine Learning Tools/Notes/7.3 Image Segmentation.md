> [!idea] Image Segmentation using Clustering
>
> Image segmentation partitions an image into multiple segments, essentially grouping pixels. Clustering algorithms can achieve simpler forms of segmentation by grouping pixels with similar features (like color). Understanding the main goals helps clarify different approaches:
>
> Imagine an image containing **two dogs** and **three cats** playing on grass.
>
> * **Semantic Segmentation**: The goal here is to label pixels based on their object *category*.
>     * All pixels belonging to *any* dog would be assigned the label "dog" (e.g., colored red).
>     * All pixels belonging to *any* cat would be assigned the label "cat" (e.g., colored blue).
>     * All pixels belonging to the grass would be labeled "grass" (e.g., colored green).
>     * *Result:* You know where the dogs, cats, and grass are, but you can't distinguish dog #1 from dog #2 within the "dog" segment.
>
> * **Instance Segmentation**: This goes a step further and aims to identify each individual object *instance*.
>     * Pixels for dog #1 get a unique label, like "dog_1" (e.g., red).
>     * Pixels for dog #2 get a different unique label, like "dog_2" (e.g., orange).
>     * Pixels for cat #1 get "cat_1" (e.g., blue).
>     * Pixels for cat #2 get "cat_2" (e.g., light blue).
>     * Pixels for cat #3 get "cat_3" (e.g., cyan).
>     * Pixels for the grass get "grass" (e.g., green).
>     * *Result:* You can distinguish each individual animal, even those of the same category.
>
> While advanced techniques like neural networks are often used for these tasks, clustering provides a basis for simpler segmentation approaches, such as grouping by color.

> [!example] Color Segmentation with K-Means
>
> A specific application of clustering for segmentation is **color segmentation**, where pixels are grouped based on having similar colors. This can be useful for tasks like analyzing satellite images for areas with similar vegetation based on color. K-Means can perform this:
>
> 1.  **Load & Reshape Image**: Load the image into a NumPy array (Height x Width x Channels). Treat each pixel's color channels (e.g., R, G, B values) as a data point by reshaping the image array into a 2D array (Pixels x Channels).
>     ```python
>     import PIL
>     import numpy as np
>     from sklearn.cluster import KMeans
>
>     # filepath = "path/to/your/image.png" # e.g., ladybug.png
>     # image = np.asarray(PIL.Image.open(filepath))
>     # Example shape: (533, 800, 3)
>
>     # Reshape to (num_pixels, num_channels)
>     # X = image.reshape(-1, 3)
>     ```
>
> 2.  **Cluster Colors**: Apply K-Means to this 2D array of pixel colors to group them into $k$ clusters. Each cluster center will represent a dominant color.
>     ```python
>     # k = 8 # Choose the number of dominant colors
>     # kmeans = KMeans(n_clusters=k, random_state=42).fit(X)
>     ```
>
> 3.  **Reconstruct Segmented Image**: Replace each pixel's original color vector with the color vector of its assigned cluster's centroid. Reshape this data back into the original image dimensions (Height x Width x Channels).
>     ```python
>     # Assign each pixel the color of its cluster center
>     # segmented_colors = kmeans.cluster_centers_[kmeans.labels_]
>     # Reshape back to original image dimensions
>     # segmented_img = segmented_colors.reshape(image.shape)
>     # segmented_img_display = segmented_img.astype(np.uint8) # Cast for display
>     ```
> This results in an image composed of only the $k$ dominant colors identified by K-Means.
>
> ```image_goes_here
> Caption: Figure 9-12. Image segmentation using K-Means with various numbers of color clusters.
> Description: A series of images demonstrating the result of K-Means color segmentation. The original image (top left) is a photo of a ladybug on a flower. Subsequent images show the result of applying K-Means with decreasing numbers of clusters (k=10, 8, 6, 4, 2), resulting in images with fewer distinct colors. As k decreases, the image becomes more blocky/stylized, grouping similar colors (like different shades of green) into single representative colors. Shows K-Means limitation: with low k, the small red ladybug's color gets merged with other clusters.
> ```