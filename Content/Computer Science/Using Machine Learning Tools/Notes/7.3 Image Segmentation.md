> [!idea] Image Segmentation Concepts
>
> Image segmentation is the task of partitioning a digital image into multiple distinct segments or regions. The goal is often to simplify the image representation or to locate objects and boundaries. Key types include:
> * **Semantic Segmentation**: Assigns all pixels belonging to the same object *category* (e.g., 'car', 'pedestrian', 'road') to the same segment. Multiple objects of the same type share the same segment label.
> * **Instance Segmentation**: Assigns all pixels belonging to the same distinct object *instance* to the same segment. Each individual object (e.g., each specific car, each individual pedestrian) gets its own unique segment label.
>
> Achieving accurate semantic or instance segmentation typically involves advanced deep learning models like Convolutional Neural Networks (CNNs).

> [!example] Example: Color Segmentation using K-Means
>
> A simpler segmentation approach focuses on grouping pixels by color similarity, known as **color segmentation**. This can be sufficient for tasks like analyzing satellite images for forest cover based on color. K-Means clustering can perform color segmentation:
>
> 1.  **Treat Colors as Data**: Each pixel's color (e.g., RGB values) is considered a data point in color space.
> 2.  **Cluster Colors**: K-Means groups these color data points into $k$ clusters. Each cluster center represents a dominant color.
> 3.  **Implementation Steps**:
>     * Load the image and reshape it into a 2D array (pixels x color channels).
>         ```python
>         import PIL
>         import numpy as np
>         from sklearn.cluster import KMeans
>
>         filepath = "ladybug.png" # Example image path
>         image = np.asarray(PIL.Image.open(filepath))
>         # Reshape to (num_pixels, num_channels)
>         X = image.reshape(-1, 3)
>         ```
>     * Apply `KMeans` to cluster the pixel colors into $k$ groups.
>         ```python
>         k = 8 # Number of dominant colors (clusters) to find
>         kmeans = KMeans(n_clusters=k, random_state=42).fit(X)
>         ```
>     * Reconstruct the image by replacing each pixel's color with its assigned cluster's center color. Reshape back to original image dimensions.
>         ```python
>         # Get the color of the centroid for each pixel's assigned label
>         segmented_colors = kmeans.cluster_centers_[kmeans.labels_]
>         # Reshape back to the original image shape
>         segmented_img = segmented_colors.reshape(image.shape)
>         # segmented_img_display = segmented_img.astype(np.uint8) # Cast for display/saving
>         ```
> This segments the image into $k$ color regions.
>
> ```image_goes_here
> Caption: Figure 9-12. Image segmentation using K-Means with various numbers of color clusters.
> Description: A series of images demonstrating the result of K-Means color segmentation. The original image (top left) is a photo of a ladybug on a flower. Subsequent images show the result of applying K-Means with decreasing numbers of clusters (k=10, 8, 6, 4, 2), resulting in images with fewer distinct colors. As k decreases, the image becomes more blocky/stylized, grouping similar colors (like different shades of green) into single representative colors. Shows K-Means limitation: with low k, the small red ladybug's color gets merged with other clusters.
> ```