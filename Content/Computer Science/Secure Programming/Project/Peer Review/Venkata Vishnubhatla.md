## 1. Project Overview
- **Group Members:**
  - Bradley Hill
  - James Nguyen
  - Natanand Akomsoontorn
  - Vincent Scaffidi-Muta


## 2. Manual Code Review

### Architecture and Design

| **Aspect**                                               | **Status**               | **Comments**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| -------------------------------------------------------- | ------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Protocol Implementation Adherence**                    | Mostly Adhered           | The code attempts to implement the OLAF/Neighbourhood protocol and handles specified message types such as `hello`, `chat`, `public_chat`, `client_list_request`, and `client_update`. However, there is a discrepancy in the `client_update` message format. The code sends the `clients` field as a list of base64-encoded PEM strings, whereas the protocol specifies it should be a list of PEM-formatted public keys without base64 encoding. This inconsistency may lead to interoperability issues with other implementations strictly following the protocol. Further verification during dynamic analysis will be conducted to verify. However, this is a minor issue and adherence is otherwise exemplary.  |
| **Security Measures (Encryption, Authentication, etc.)** | Incorrect Implementation | While the code incorporates basic encryption and signing mechanisms, it does not fully adhere to the protocol specifications. For asymmetric encryption, RSA with OAEP padding and SHA-256 is correctly used. However, for signing, the code uses PKCS1v15 padding instead of RSA-PSS with SHA-256 as specified in the protocol. Additionally, symmetric encryption uses AES in CBC mode with PKCS7 padding, whereas the protocol mandates AES in GCM mode. These deviations could introduce security vulnerabilities and affect compatibility with other protocol-compliant implementations.                                                                                                                         |

### Code Quality

| **Aspect**                       | **Status** | **Comments**                                                                                                                                                                                                                                                                                                                                                                                                        |
| -------------------------------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Readability and Organization** | Needs      | The code is generally organized into functions and classes, making it somewhat readable. However, there are areas where refactoring could improve clarity and maintainability. Variable names are sometimes non-descriptive, and there is a lack of inline comments explaining complex sections, which may hinder understanding for new developers.                                                                 |
| **Error Handling and Logging**   | ⚠️ Basic   | Error handling is present but inconsistent across the codebase. Exceptions are occasionally caught and printed, but not always handled appropriately or propagated. Logging relies on simple `print` statements for debugging, which is insufficient for monitoring and diagnosing issues in a production environment. Implementing a structured logging framework would enhance debuggability and maintainability. |

### Security-specific Checks

| **Aspect**                               | **Status**                 | **Comments**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Input Validation**                     | ⚠️ Insufficient            | Input validation is minimal throughout the code. In functions like `process_message`, the code assumes that incoming data is well-formed without thorough validation of message structures or contents. This lack of validation could lead to the processing of malformed or malicious data, potentially causing unexpected behavior or security vulnerabilities. Implementing strict input validation and sanitation is recommended to mitigate these risks.                                                                                                                                                                                                                                                                                                                                               |
| **Access Control**                       | ❌ Potentially Broken       | The `is_server` variable in the `ClientSession` class poses a security risk. Any client can send a `server_hello` message, causing their session to be marked as `is_server = True`, which bypasses signature verification in subsequent messages. This could allow an attacker to send unsigned or malicious messages without proper authentication. The code lacks robust mechanisms to authenticate and verify the identities of servers versus clients, compromising access control. It's crucial to implement proper authentication checks to distinguish between trusted servers and regular clients reliably.                                                                                                                                                                                   |
| **Cryptographic Implementations**        | ❌ Incorrect Implementation | The cryptographic implementations do not align with the protocol specifications. For signing, the code uses RSA with PKCS1v15 padding instead of the required RSA-PSS with SHA-256. For symmetric encryption, AES in CBC mode with PKCS7 padding is used, whereas the protocol specifies AES in GCM mode. These deviations may weaken the security of the system and lead to vulnerabilities. Additionally, the use of base64 encoding for PEM keys where raw PEM formats are expected can cause interoperability issues. Correcting these implementations to match the protocol is essential for security and compatibility.                                                                                                                                                                                        |
| **Secure Data Storage and Transmission** | ❌ Insecure Transmission    | Data transmission is not secured at the transport layer. The server communicates over plain TCP sockets without TLS encryption, and the Flask application for file uploads/downloads operates over HTTP rather than HTTPS. This exposes sensitive data to potential interception and eavesdropping. The lack of secure channels undermines the application's security measures. Implementing TLS for both socket communication and the Flask application is strongly recommended to protect data in transit and ensure confidentiality and integrity. |

---