## 1. Project Overview
- **Group Members:**
  - Bradley Hill
  - James Nguyen
  - Natanand Akomsoontorn
  - Vincent Scaffidi-Muta

- **Reviewers:**
  - [Reviewer Names Here]

## 2. Manual Code Review

### Architecture and Design

| **Aspect**                            | **Status**               | **Comments**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ------------------------------------- | ------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Protocol Implementation Adherence** | ⚠️ Partially Adhered     | The implementation largely follows the OLAF/Neighbourhood protocol specifications, particularly in aspects like message signing, encryption, and routing through peer servers. However, there is a significant issue with the **client update lists**. According to the protocol, the client update lists should consist of **lists of PEM-encoded public keys**. In the provided code, the `client_update` messages are sending **sets of public keys** instead of lists. For instance, in the `send_clients_of_this_server` function, the clients are aggregated into a list but are stored and managed as sets within the `server_public_keys` dictionary. This discrepancy can lead to inconsistencies in JSON serialization and potential interoperability issues with other groups' implementations. I believe this is evident from the code review, but it will need to be verified during dynamic analysis.                                                                                                                                                                                  |
| **Security Measures**                 | ⚠️ Partially Implemented | The code incorporates several security measures as per the protocol, including the use of RSA for asymmetric encryption and AES for symmetric encryption. Message signing using RSA-PSS with SHA-256 is also implemented to ensure data integrity and authenticity. However, there are concerns regarding **access control** and the handling of the `is_server` variable. The `is_server` flag is used to differentiate between server and client sessions, but its implementation raises questions about whether it effectively enforces access control. Specifically, it's unclear if this flag restricts or grants access to certain functionalities, potentially leading to unauthorized actions if not managed correctly. Additionally, while public keys are being exchanged and verified, the overall **access control mechanism** might be vulnerable if the `is_server` flag is manipulated or not consistently enforced across all message handling functions. This aspect requires a thorough review to ensure that it does not inadvertently weaken the security posture of the system. |

### Code Quality

| **Aspect**                       | **Status**           | **Comments**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------|----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Readability and Organization** | ⚠️ Moderate          | The codebase is moderately organized, with clear separation between server and client functionalities. However, there are areas where readability can be improved. For instance, the repeated imports and redundant function definitions, such as multiple `generate_keys` and `sign_data` functions in both server and client scripts, can be consolidated into shared modules to reduce duplication. Additionally, some functions are lengthy and handle multiple responsibilities, which can be broken down into smaller, more focused functions to enhance maintainability and clarity. Comments are present but could be more descriptive to explain complex sections, especially around encryption and message processing logic. |
| **Error Handling and Logging**   | ⚠️ Inadequate         | Error handling is present but lacks comprehensiveness. For example, in the `upload_file` function within the server, errors are minimally handled with generic responses, which may not provide sufficient context for debugging or user feedback. Similarly, in the client-side `decrypt_message` function, exceptions are caught and printed, but there is no retry mechanism or user notification for failed decryption attempts. Logging is primarily done using `print` statements, which are not ideal for production environments. Implementing a more robust logging framework with different log levels (e.g., INFO, WARNING, ERROR) would improve the ability to monitor and debug the system effectively. |

### Security-specific Checks

| **Aspect**                               | **Status**                 | **Comments**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|------------------------------------------|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Input Validation**                     | ⚠️ Insufficient             | Input validation is minimally implemented. For instance, the server does not thoroughly validate the structure and content of incoming JSON messages beyond basic type checks. In the client, user inputs for sending messages and file operations are not adequately sanitized, which could lead to injection attacks or malformed data being processed. Additionally, the `upload_file` and `download_file` functionalities lack checks to ensure that only allowed file types and sizes are processed, potentially exposing the system to file-based attacks. Strengthening input validation across all message handlers and user inputs is essential to mitigate these risks. |
| **Access Control**                       | ⚠️ Potential Flaws         | The `is_server` variable is used to distinguish between server and client sessions, but its role in enforcing access control is unclear. If not properly managed, this flag could allow unauthorized access to server-level functionalities by manipulating session states. For example, if a client session inadvertently sets `is_server` to `True`, it might gain access to privileged operations meant only for server sessions. Moreover, there is no explicit role-based access control mechanism to restrict actions based on user roles or permissions, which could lead to privilege escalation attacks. A more robust and explicit access control framework is needed to ensure that only authorized entities can perform sensitive operations within the system. |
| **Cryptographic Implementations**        | ⚠️ Partially Correct        | The cryptographic implementations adhere to the protocol specifications in terms of key sizes and padding schemes. RSA with OAEP and PSS padding, along with AES in CBC mode, are correctly utilized for encryption and signing purposes. However, there are inconsistencies in how cryptographic functions are invoked and managed across the server and client. For example, the encryption and decryption functions in the client might not fully align with the server's expectations, potentially leading to interoperability issues. Additionally, the use of base64 encoding for keys and messages is correctly implemented, but ensuring that all cryptographic operations are securely managed and free from side-channel vulnerabilities requires further verification. |
| **Secure Data Storage and Transmission** | ⚠️ Partially Secure         | Data transmission is secured using WebSockets, but the implementation does not enforce the use of secure WebSockets (`wss://`), leaving the data potentially vulnerable to interception and man-in-the-middle attacks. The storage of uploaded files is handled with basic safeguards using `secure_filename`, but there is no encryption of stored files, which could expose sensitive data if the server is compromised. Moreover, the client does not verify the integrity of downloaded files beyond basic HTTP status checks, which might allow tampering during transmission. Enhancing data transmission security by enforcing `wss://` and implementing encryption for stored files would significantly improve the system's overall security posture. |

---

**Note:** This review focuses solely on sections 1 and 2 (Project Overview and Manual Code Review) as per your request. Further sections will be addressed in subsequent reviews.