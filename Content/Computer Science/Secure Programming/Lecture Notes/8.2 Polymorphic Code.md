> [!idea] Polymorphic Code
> Polymorphic code is a malware evasion technique that **changes the appearance of malicious code** without altering its functionality.
> 
> **Key mechanics:**
> - **Encrypts the main virus code** using different keys or initialization vectors for each instance
> - **Includes a decryption routine** that remains constant but may be obfuscated
> - **Generates unique encryption keys** for each new virus copy
> 
> **How it works:**
> 1. The virus encrypts its payload and propagation instructions
> 2. It attaches a decryption routine and the unique key
> 3. When executed, it decrypts and runs the main virus code
> 4. For propagation, it re-encrypts the payload with a new key
> 
> This process creates **variable virus signatures** while maintaining identical malicious behavior, effectively evading signature-based detection methods.
> 
> ![[Pasted image 20241006071537.png|500]]

> [!consider] Defending Against Polymorphic Code
> **1. Detecting decryptor code**
> - **Advantage:** Less code to match in signatures
> - **Challenges:**
>   - Higher false positive rate
>   - Decryptor code may be scattered across memory
> 
> **2. Identifying decryption behavior**
> - **Methods:**
>   - Sandbox execution
>   - Static analysis
> - **Difficulties:**
>   - Distinguishing from legitimate decryption (e.g., zip files)
>   - Determining appropriate execution time in sandboxes
> 
> These approaches aim to identify polymorphic malware by focusing on consistent elements or behaviors rather than the variable encrypted payload.

