> [!example] Deadlock Scenario
> Consider two threads, A and B, each needing two resources, R1 and R2, to complete their tasks:
> 
> ```
> Thread A:
> 1. Acquire R1
> 2. Acquire R2
> 3. Use R1 and R2
> 4. Release R2
> 5. Release R1
> 
> Thread B:
> 1. Acquire R2
> 2. Acquire R1
> 3. Use R2 and R1
> 4. Release R1
> 5. Release R2
> ```
> 
> If Thread A acquires R1 and Thread B acquires R2 simultaneously, **both threads will be stuck waiting for the other resource indefinitely**. This situation is a deadlock.

> [!idea] Deadlock
> A deadlock is a concurrent systems problem where **two or more processes are unable to proceed because each is waiting for the other to release a resource.**
> 
> Key characteristics of a deadlock:
> - **Mutual Exclusion**: At least one resource must be held in a non-sharable mode.
> - **Hold and Wait**: A process must be holding at least one resource while waiting to acquire additional resources held by other processes.
> - **No Preemption**: Resources cannot be forcibly taken away; they must be released voluntarily by the process holding them.
> - **Circular Wait**: A circular chain of two or more processes, each waiting for a resource held by the next process in the chain.

> [!consider] Factorio Trains Deadlock
> Consider our Factorio railway system from before. If we add 1 more train to the network, we experience a deadlock. Each train is trying to move to a station that is mutually blocked by another train. A train in the top left is trying to get to the bottom right, but cant because a train is there. That train is trying to get to the bottom left, because there is a train there also!
> 
> ![[Pasted image 20240910050428.png]]
> 
> 
> This scenario mirrors the deadlock conditions:
> 1. **Mutual Exclusion**: Each track segment can only be used by one train at a time.
> 2. **Hold and Wait**: Each train holds one track while waiting for the other.
> 3. **No Preemption**: Trains can't be forcibly removed from tracks.
> 4. **Circular Wait**: Train A-B is waiting for Train C-D, which is waiting for Train A-B.
> 
> To prevent this in Factorio, players often implement **signaling systems** or **design intersections** that allow trains to wait before entering the intersection, effectively avoiding the "Hold and Wait" condition.