> [!idea] Pointer Authentication
> Pointer Authentication (PA) enhances stack protection by embedding security within pointers themselves.
> - **Builds on stack canaries** concept
> - Stores a secret value (Pointer Authentication Code or PAC) within unused bits of 64-bit addresses
> - Utilizes typically unused higher-order bits (e.g., 22 bits in 42-bit addressing systems)
> 
> Process:
> 1. Generate PAC for pointer
> 2. Before pointer use, verify PAC
> 3. If valid, restore unused bits and use address
> 4. If invalid, crash program
> 
> Application:
> - Can be applied to pointers on stack and heap

> [!idea] PAC Properties
> Pointer Authentication Codes (PACs) have specific properties that enhance security:
> - **Unique PAC per address**: Prevents address modification without PAC alteration
> - **CPU-generated**: Uses a master secret inaccessible to programs
> - **Comprehensive coverage**: Applicable to all pointers in memory

> [!consider] Breaking Pointer Authentication
> Potential attack vectors on Pointer Authentication:
> - **PAC Generation Manipulation**: Tricking program to generate PAC for specific address
> - **Master Secret Extraction**: Exploiting OS vulnerabilities (highly improbable due to hardware implementation)
> - **Brute Force Attacks**: Possible due to limited PAC bit space (2^22 combinations)
> - **Pointer Reuse**: Copying PAC from one pointer to another

> [!idea] Pointer Reuse Attack
> Pointer Reuse is a method to bypass Pointer Authentication:
> 1. **Identify valid pointer** with authenticated PAC
> 2. **Copy entire pointer** including PAC
> 3. **Use copied pointer** in different context
> 4. System accepts PAC as valid, potentially allowing unauthorized access

> [!consider] Defending Against Pointer Reuse
> Strategies to mitigate Pointer Reuse attacks:
> - **Multiple master secrets**: ARM implements 5 types (IA, OB, DA, DB, GA) for different pointer categories
> - **Context-specific PACs**: Generate unique PACs based on pointer location
>   - Prevents direct copying of pointers between contexts
> - **Limited availability**: Currently implemented in ARM and select architectures
>   - Not available in x86, making ARM-based systems (e.g., Macs) potentially more secure in this aspect
