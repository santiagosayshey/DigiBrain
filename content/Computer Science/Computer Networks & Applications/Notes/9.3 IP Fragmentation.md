> [!consider] The Problem of Varying MTU Sizes Across Networks
>
> Networks have different Maximum Transmission Unit (MTU) sizes, which limits the size of incoming and outgoing packets.
> - Issues arise when a host sends an IP packet larger than the outgoing link's MTU:
>   - Large packets are dropped, causing communication failures.
>   - Applications must adapt to varying MTUs, increasing complexity.
>   - Network efficiency suffers, limited by the smallest MTU in the path.
> - A mechanism is needed to handle packet sizes exceeding the MTU of network links.
>
> | Scenario                   | Problem                               |
> |----------------------------|---------------------------------------|
> | Large packet vs. small MTU | Packet dropped, communication failure |
> | Application complexity     | High, need to adapt to varying MTUs   |
> | Network efficiency         | Low, limited by smallest MTU in path  |
>
> Without a solution, network communication would be unreliable and inefficient.

> [!idea] IP Fragmentation
> 
> IP fragmentation is the process of **breaking down large IP packets into smaller pieces** (fragments) to fit the Maximum Transmission Unit (MTU) of the network. This allows data to be transmitted across networks with different MTU sizes.

> [!example] IP Fragmentation Process
>
> When a router receives an IP packet larger than the MTU of the outgoing link:
> 1. The router divides the packet into smaller fragments.
> 2. Each fragment is assigned a unique identifier and offset value.
> 3. The fragments are sent independently to the destination.
> 4. The receiving host reassembles the fragments based on their identifiers and offsets.
>
> | Field          | Description                                  |
> |----------------|----------------------------------------------|
> | Identification | Unique identifier for the original datagram  |
> | Flags          | Indicates if more fragments follow           |
> | Fragment Offset| Specifies the position of the fragment       |

> [!consider] Fragmentation Overhead and Issues
>
> - Fragmentation increases overhead due to additional header information.
> - If one fragment is lost, the entire packet must be retransmitted.
> - Fragmentation can be used in DoS attacks (e.g., ping of death).
> - IPv6 does not allow fragmentation by routers, only by the source host.

> [!idea] Path MTU Discovery (PMTUD)
>
> Path MTU Discovery is a technique used to determine the maximum packet size that can be sent without fragmentation across a network path. It helps optimize network performance by avoiding unnecessary fragmentation.

> [!example] PMTUD Process
>
> 1. The source host sends a packet with the "Don't Fragment" (DF) flag set.
> 2. If a router along the path has an MTU smaller than the packet size, it drops the packet and sends an ICMP "Fragmentation Needed" message back to the source.
> 3. The source host adjusts its packet size based on the ICMP message and retransmits.
> 4. The process repeats until the packet reaches the destination without fragmentation.

> [!consider] PMTUD Limitations and Alternatives
>
> - PMTUD relies on ICMP messages, which may be blocked by firewalls.
> - Alternatives to PMTUD include:
>   - Plumb MTU Discovery: Assumes the minimum MTU of the path is the same as the first hop.
>   - Packetization Layer Path MTU Discovery (PLPMTUD): Uses a feedback mechanism from the transport layer to detect and adjust the MTU.



