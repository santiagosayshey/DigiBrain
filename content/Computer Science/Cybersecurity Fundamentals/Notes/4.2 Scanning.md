
> [!idea]+ Idea
> Network Scanning is an intent and methodical process of uncovering the structure of the network (including firewalls), hosts and applications on it. It helps us to:
> - Reveal new vulnerabilities
> - Detect vulnerable hosts
> - Monitor services deployment
> 
> Scanning helps us find:
> - IP addresses
> - OS versions
> - MAC Addresses
> - Services information
> - Port data
> 
> Scanners should be **fast, scalable and non-intrusive**

| Scan Type | Description | Characteristics | Syntax |
|-----------|-------------|-----------------|--------|
| TCP Full Connect | Completes the full TCP three-way handshake to determine port status | - Most accurate<br>- Easily logged | nmap -sT -v <target IP> |
| Half Open | Begins like full connect but doesn't complete handshake | - Faster than full connect<br>- Lower chance of being logged | nmap -sS -v <target IP> |
| XMAS | Sends packet with PSH, URG, and FIN flags set simultaneously | - Uses illegal flag combination<br>- Doesn't work on most modern systems | nmap -sX -v <target IP> |
| FIN | Sends packet with only FIN flag set to probe ports | - Responses indicate port state<br>- May not function on newer targets<br>- Can be blocked by firewalls | N/A |
| Banner Grabbing | Retrieves information about target system and services | - Identifies OS and running services<br>- Collects application-specific details from services<br>- Can use Telnet or SSH | N/A |

> [!consider] Consider
> Now that an attacker knows what OS and applications are installed, they can:
> - Exploit vulnerabilities
> - Find common config errors
> - Exploit default configs
> 
> **Firewalk: Determining Firewall Rules**
> - Find out firewall rules for new connections
> - We don't care about target machine, just about packet types that can get through the firewall
>     - Find out distance to firewall using traceroute
>     - Ping arbitrary destination setting TTL=distance+1
>     - If you receive ICMP_TIME_EXCEEDED message, the ping went through
> 
> **Network Mapping**
> **Finding live hosts**
> - Ping sweep
> - TCP SYN sweep
> 
> **Map network topology**
> - Traceroute
>     - Sends out ICMP or UDP packets with increasing TTL
>     - Gets back ICMP_TIME_EXCEEDED message from intermediate routers
