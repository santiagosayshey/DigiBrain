> [!motivation] Session Hijacking Vulnerability
>
> When **a user logs in, the server issues a unique token stored as a cookie** in the user's browser. This **cookie is automatically included in subsequent requests**, allowing the server to recognize the authenticated session.
>
> However, if an attacker can manipulate the user's browser into sending a request to the target website with the user's session cookie, the **attacker can hijack the legitimate session and perform unauthorized actions** on behalf of the user.

> [!idea] Cross-Site Request Forgery (CSRF)
>
> CSRF is an attack technique that exploits the trust a web application has in an authenticated user's session. The attacker crafts a malicious website/email containing code that triggers the victim's browser to send an unintended request to the vulnerable website. This request includes the victim's session cookie, making it appear legitimate to the target website.
>
> By processing this forged request as authentic based on the victim's cookie, the web application allows the attacker to perform actions like transferring funds, modifying account details, or executing unauthorized operations under the victim's identity.

> [!example] CSRF Attack Example
>
> ```html
> <!-- Attacker's Malicious Code -->
> <img src="https://bank.com/transfer?amt=1000&to=attacker" />
> ```
>
> 1. Attacker embeds malicious code in a website or email
> 2. Victim visits the attacker's site/email while authenticated with bank
> 3. Code triggers a request to bank, including victim's session cookie
> 4. Bank processes request as legitimate, transferring funds to attacker

> [!consider] Distinguishing from XSS
>
> | CSRF | Reflected XSS |
| --- | --- |
| Exploits trust in authenticated sessions | Injects scripts into web app responses |
| Triggers unauthorized requests with user's cookie | Executes malicious scripts in victim's browser |
| Performs unauthorized actions on user's behalf | Potential data theft, further malicious actions |

> [!consider] Preventing CSRF Attacks
>
> - **Synchronizer Tokens**: Unique, unpredictable tokens generated by server and validated per request. Requests without valid tokens are rejected.
> - **SameSite Cookies**: Limit inclusion of cookies in cross-site requests using `SameSite` attribute (see next callout).
> - **Referer Validation**: Check `Referer` header to ensure requests originate from trusted sources, not external domains.
> - **CSRF Tokens in URLs**: Include unique tokens as parameters for sensitive requests like `POST`/`DELETE` and validate on server.

> [!consider] SameSite Cookies
>
> - `SameSite` cookie attribute instructs browser on including cookies in cross-site requests
> - `Strict`: Cookies included only in same-site requests (highest protection)
> - `Lax`: Included in same-site requests and top-level cross-site navigations
> - `None`: Included in all requests (disables `SameSite` protection)
> - Setting to `Strict` or `Lax` reduces CSRF risk but should be combined with other techniques

Let me know if this version strikes a better balance between being concise while still providing sufficient details and explanations.