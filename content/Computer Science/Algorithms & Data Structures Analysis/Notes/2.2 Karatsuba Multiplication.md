
> [!idea] The Idea
> Recall in the [[2.1 Recursive Multiplication|Recursive Multiplication Method]], our time complexity is actually not reduced below $O(n^2)$. Enter the [Karatsuba Algorithm](https://en.wikipedia.org/wiki/Karatsuba_algorithm), a faster Divide and Conquer multiplication algorithm $\approx O(n^{1.59})$.
> 
> The method is quite similar to itâ€™s predecessor, but instead of calculating 4 partial products, we only need 3. On the surface, this single multiplication decrease seems trivial, but we must understand that there is an entire operation removed PER sub level. This greatly reduces the worst case complexity of the algorithm. 
> 
> ![[Pasted image 20240311053141.png]]


> [!consider] Consider - Karatsuba vs Recursive School 
> ![[Pasted image 20240311053326.png]]
> In the Karatsuba method, leaf nodes are reached more quickly compared to the recursive school method. The Karatsuba algorithm has a shallower tree structure with fewer levels, allowing it to arrive at the base cases (leaf nodes) faster.



> [!code] Karatsuba Pseudocode
> ```c
> function karatsuba(a, b, n) {
> if n < 4
> 	return a * b
> else
> 	// Split the numbers
> 	a1, a0 = split(a)
> 	b1, b0 = split(b)
> 	
> 	// Solve three sub problems, using the Karatsuba method
> 	p0 = multiply(a0, b0, ceil(n/2)
> 	p1 = multiply(a1, b1, ceil(n/2))
> 	p2 = multiply((a0+a1),(b0+b1), b) - p0 - p1
> 	
> 	// Combine the results
> 	b^2k*p2 + b^k*p1 + p0
> }
> ```

$$
\begin{align*}
a \times b &= (a_1 B^{k} + a_0) \times (b_1 B^{k} + b_0) \\
&= (a_1 b_1) B^{2k} + (a_1 b_0 + a_0 b_1) B^{k} + a_0 b_0 && \text{(Recursive Method)} \\
&= (a_1 \times b_1) B^{2k} + \left((a_1 + a_0) \times (b_1 + b_0) - (a_1 \times b_1 + a_0 \times b_0)\right) B^{k} + a_0 \times b_0 && \text{(Karatsuba)}
\end{align*}
$$



> [!math] Karatsuba Complexity
> $$
T_K(n) \leq
\begin{cases}
3n^2 + 2n & \text{if } n < 4 \\
3 \cdot T_K\left(\left\lceil \frac{n}{2} \right\rceil + 1\right) + 6 \cdot 2 \cdot n & \text{if } n \geq 4
\end{cases}
> $$
> $$
T_K(n) \leq 207 \cdot n^{\log_3 3}
$$




